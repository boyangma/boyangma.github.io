{% include base_path %}

<!doctype html>
<html lang="{{ site.locale | slice: 0,2 }}" class="no-js"{% if site.site_theme == "dark" %} data-theme="dark"{% endif %}>
  <head>
    {% include head.html %}
    {% include head/custom.html %}
  </head>

  <body>

    {% include browser-upgrade.html %}
    {% include masthead.html %}

    {{ content }}

    <div class="page__footer">
      <footer>
        {% include footer/custom.html %}
        {% include footer.html %}
      </footer>
    </div>

    {% include scripts.html %}
    
    <script>
      function setAllLinksToBlank() {
        var links = document.querySelectorAll('a[href]');
        links.forEach(function (link) {
          // 排除顶部导航栏的链接
          var isNavLink = link.closest('.masthead') || 
                         link.closest('.site-nav') || 
                         link.closest('.navigation') ||
                         link.closest('nav') ||
                         link.closest('.navbar') ||
                         link.closest('.menu');
          
          // 如果不是导航链接，就设置为新窗口打开
          if (!isNavLink && link.target !== '_blank') {
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
          }
        });
      }

      // 确保在所有其他脚本执行完后再执行
      setTimeout(function() {
        setAllLinksToBlank();
        
        // 延迟执行
        setTimeout(setAllLinksToBlank, 500);
        setTimeout(setAllLinksToBlank, 1000);
        setTimeout(setAllLinksToBlank, 2000);
        
        // 每5秒强制检查一次
        setInterval(setAllLinksToBlank, 5000);
      }, 100);
    </script>
    
  </body>
    
</html>